name: Rust

on: [push,pull_request]

# Note, toolchain version must match the rustup version: either "nightly" or "nightly-YYYY-MM-DD"
# and must contain the toolchain for the OS at the end.

env:
  VCPKGRS_DYNAMIC: 1
  #TOOLCHAIN_VERSION: stable-x86_64-pc-windows-msvc

jobs:

  CheckFormat:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Checks Ballista formatting
        run: cd rust && cargo fmt -- --check > /dev/null || echo "Please run cargo fmt on your commit." && ( exit 1 )

  Lint:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Lint Ballista
      run: cd rust && cargo clippy -- -D warnings

  TestDependentAction:
    runs-on: ubuntu-latest
    needs: 
      - CheckFormat
      - Lint
    steps:
    - uses: actions/checkout@v2
    - name: Change to rust directory
      run: cd rust 
